# DevOps Engineer â€” Orbit

> **Owner:** DevOps Lead  
> **Scope:** Infrastructure, CI/CD, deployment, monitoring, reliability

---

## ğŸ¯ Mission

Ensure Orbit is **always available, fast, and easy to deploy**. Build infrastructure that scales with users and enables rapid, safe deployments. Zero-downtime is the goal.

---

## ğŸ“ Infrastructure Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           PRODUCTION INFRASTRUCTURE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚     â”‚                         Cloudflare                               â”‚  â”‚
â”‚     â”‚                  (CDN, DDoS, SSL, DNS)                          â”‚  â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚         â”‚                                               â”‚                â”‚
â”‚         â–¼                                               â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚     Vercel      â”‚                         â”‚    Railway      â”‚        â”‚
â”‚  â”‚   (Frontend)    â”‚                         â”‚   (Backend)     â”‚        â”‚
â”‚  â”‚                 â”‚                         â”‚                 â”‚        â”‚
â”‚  â”‚  â€¢ Next.js/Vite â”‚ â—€â”€â”€â”€â”€â”€â”€ API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚  â€¢ FastAPI      â”‚        â”‚
â”‚  â”‚  â€¢ Static CDN   â”‚                         â”‚  â€¢ Auto-scale   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                       â”‚                  â”‚
â”‚                                                       â”‚                  â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚         â”‚                                             â”‚          â”‚      â”‚
â”‚         â–¼                                             â–¼          â–¼      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    Supabase     â”‚                         â”‚   Redis   â”‚ â”‚ Sentry â”‚  â”‚
â”‚  â”‚   (Postgres)    â”‚                         â”‚  (Upstash)â”‚ â”‚ (Logs) â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ Platform Choices

### Development (Local)

| Component | Tool | Notes |
|-----------|------|-------|
| **Orchestration** | Docker Compose | All services in one command |
| **Database** | PostgreSQL 15 | Same as production |
| **Cache** | Redis | For sessions, rate limits |
| **API Docs** | Swagger UI | Auto-generated by FastAPI |

### Production (Portfolio-Friendly, Free Tier)

| Component | Platform | Why |
|-----------|----------|-----|
| **Frontend** | Vercel | Free, automatic deploys, CDN |
| **Backend** | Railway | Generous free tier, easy deploys |
| **Database** | Supabase (Postgres) | Free tier, managed |
| **Cache** | Upstash Redis | Free tier, serverless |
| **Monitoring** | Sentry | Free tier, error tracking |
| **DNS/CDN** | Cloudflare | Free, DDoS protection |

### Production (Scale-Ready Alternative)

| Component | Platform | When to Use |
|-----------|----------|-------------|
| **Compute** | AWS ECS / GCP Cloud Run | Need more control |
| **Database** | AWS RDS / GCP Cloud SQL | Production workloads |
| **Cache** | AWS ElastiCache | High-volume caching |
| **CDN** | CloudFront / Cloud CDN | Global distribution |

---

## ğŸ³ Docker Configuration

### docker-compose.yml (Development)

```yaml
version: '3.8'

services:
  # PostgreSQL Database
  db:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: orbit
      POSTGRES_PASSWORD: orbit_dev_password
      POSTGRES_DB: orbit
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U orbit"]
      interval: 5s
      timeout: 5s
      retries: 5

  # Redis Cache
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 5s
      retries: 5

  # Backend API
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://orbit:orbit_dev_password@db:5432/orbit
      - REDIS_URL=redis://redis:6379
      - ENV=development
    depends_on:
      db:
        condition: service_healthy
      redis:
        condition: service_healthy
    volumes:
      - ./backend:/app
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

  # Frontend (optional, can use npm run dev instead)
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "3000:3000"
    environment:
      - VITE_API_URL=http://localhost:8000
    volumes:
      - ./frontend:/app
      - /app/node_modules
    command: npm run dev -- --host

volumes:
  postgres_data:
```

### Backend Dockerfile

```dockerfile
# backend/Dockerfile
FROM python:3.11-slim

WORKDIR /app

# Install dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy application
COPY . .

# Run with uvicorn
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

### Frontend Dockerfile

```dockerfile
# frontend/Dockerfile
FROM node:20-alpine

WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm ci

# Copy application
COPY . .

# Build for production
RUN npm run build

# Serve with nginx (production)
FROM nginx:alpine
COPY --from=0 /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

---

## ğŸ”„ CI/CD Pipeline

### GitHub Actions Workflow

```yaml
# .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]

env:
  NODE_VERSION: '20'
  PYTHON_VERSION: '3.11'

jobs:
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Frontend CI
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  frontend-ci:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: frontend
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ env.NODE_VERSION }}
          cache: 'npm'
          cache-dependency-path: frontend/package-lock.json
      
      - name: Install dependencies
        run: npm ci
      
      - name: Type check
        run: npm run typecheck
      
      - name: Lint
        run: npm run lint
      
      - name: Test
        run: npm run test -- --coverage
      
      - name: Build
        run: npm run build
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          directory: frontend/coverage

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Backend CI
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  backend-ci:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: backend
    
    services:
      postgres:
        image: postgres:15
        env:
          POSTGRES_USER: test
          POSTGRES_PASSWORD: test
          POSTGRES_DB: orbit_test
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432
      
      redis:
        image: redis:7
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 6379:6379
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: ${{ env.PYTHON_VERSION }}
          cache: 'pip'
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          pip install -r requirements-dev.txt
      
      - name: Lint
        run: |
          ruff check .
          ruff format --check .
      
      - name: Type check
        run: mypy app/
      
      - name: Run tests
        env:
          DATABASE_URL: postgresql://test:test@localhost:5432/orbit_test
          REDIS_URL: redis://localhost:6379
        run: pytest --cov=app --cov-report=xml
      
      - name: Upload coverage
        uses: codecov/codecov-action@v3
        with:
          directory: backend

  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # Deploy (only on main)
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  deploy:
    needs: [frontend-ci, backend-ci]
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'
    
    steps:
      - uses: actions/checkout@v4
      
      # Vercel deploy (Frontend)
      - name: Deploy Frontend to Vercel
        uses: amondnet/vercel-action@v25
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          working-directory: frontend
      
      # Railway deploy (Backend) - uses railway.json config
      - name: Deploy Backend to Railway
        uses: bervProject/railway-deploy@v1.0.0
        with:
          railway_token: ${{ secrets.RAILWAY_TOKEN }}
          service: orbit-backend
```

---

## ğŸ“Š Monitoring & Observability

### Error Tracking (Sentry)

```python
# backend/app/main.py
import sentry_sdk
from sentry_sdk.integrations.fastapi import FastApiIntegration

sentry_sdk.init(
    dsn=settings.SENTRY_DSN,
    integrations=[FastApiIntegration()],
    traces_sample_rate=0.1,  # 10% of transactions
    environment=settings.ENV,
)
```

```typescript
// frontend/src/main.tsx
import * as Sentry from "@sentry/react";

Sentry.init({
  dsn: import.meta.env.VITE_SENTRY_DSN,
  integrations: [new Sentry.BrowserTracing()],
  tracesSampleRate: 0.1,
  environment: import.meta.env.MODE,
});
```

### Health Checks

```python
# backend/app/routers/health.py
from fastapi import APIRouter
from sqlalchemy import text

router = APIRouter()

@router.get("/health")
async def health_check():
    return {"status": "healthy"}

@router.get("/health/ready")
async def readiness_check(db: AsyncSession = Depends(get_db)):
    try:
        await db.execute(text("SELECT 1"))
        return {"status": "ready", "database": "connected"}
    except Exception as e:
        return JSONResponse(
            status_code=503,
            content={"status": "not ready", "error": str(e)}
        )
```

### Logging

```python
# backend/app/middleware/logging.py
import logging
import time
from fastapi import Request

logger = logging.getLogger("orbit")

async def log_requests(request: Request, call_next):
    start_time = time.time()
    
    response = await call_next(request)
    
    process_time = time.time() - start_time
    logger.info(
        f"{request.method} {request.url.path} "
        f"status={response.status_code} "
        f"duration={process_time:.3f}s"
    )
    
    return response
```

---

## ğŸ” Environment Configuration

### Environment Files

```bash
# .env.example (root)
# Frontend
VITE_API_URL=http://localhost:8000
VITE_SENTRY_DSN=

# Backend
DATABASE_URL=postgresql://orbit:password@localhost:5432/orbit
REDIS_URL=redis://localhost:6379
SECRET_KEY=your-secret-key-here
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
SENTRY_DSN=
ENV=development
```

### Secret Management

| Environment | Method |
|-------------|--------|
| **Local** | `.env` files (gitignored) |
| **CI/CD** | GitHub Secrets |
| **Production** | Platform-native secrets (Vercel/Railway) |

---

## ğŸš€ Deployment Guide

### First-Time Setup

1. **Create accounts:**
   - Vercel (frontend hosting)
   - Railway (backend hosting)
   - Supabase (database)
   - Upstash (Redis)
   - Sentry (monitoring)

2. **Connect repositories:**
   ```bash
   # Vercel
   vercel link
   
   # Railway
   railway link
   ```

3. **Set environment variables:**
   - Set all secrets in platform dashboards
   - Ensure DATABASE_URL and REDIS_URL are set

### Deploy Commands

```bash
# Deploy frontend to Vercel
cd frontend
vercel --prod

# Deploy backend to Railway
cd backend
railway up
```

### Rollback

```bash
# Vercel (instant rollback)
vercel rollback [deployment-url]

# Railway
railway rollback
```

---

## ğŸ“ˆ Performance Targets

| Metric | Target | Alert Threshold |
|--------|--------|-----------------|
| **API Latency (p50)** | < 100ms | > 200ms |
| **API Latency (p99)** | < 500ms | > 1000ms |
| **Uptime** | 99.9% | < 99.5% |
| **Error Rate** | < 0.1% | > 1% |
| **Frontend LCP** | < 1.5s | > 2.5s |

---

## ğŸ—“ï¸ Milestones

### Week 1: Local Dev Environment
- [ ] Docker Compose setup
- [ ] All services running locally
- [ ] Development workflow documented

### Week 2: CI/CD Pipeline
- [ ] GitHub Actions workflows
- [ ] Linting and tests in CI
- [ ] Automated deploys on main

### Week 3: Production Setup
- [ ] Vercel frontend deployment
- [ ] Railway backend deployment
- [ ] Supabase database setup
- [ ] Domain and SSL configured

### Week 4: Observability
- [ ] Sentry error tracking
- [ ] Health check endpoints
- [ ] Logging configured
- [ ] Alerts set up

---

## ğŸ“‹ Launch Checklist

Before going live:

- [ ] All secrets rotated from dev values
- [ ] Database backups configured
- [ ] Health checks passing
- [ ] SSL certificates valid
- [ ] CORS configured correctly
- [ ] Rate limiting enabled
- [ ] Error tracking working
- [ ] Rollback tested
- [ ] Performance benchmarked

---

*DevOps Engineer â€” Orbit v1.0*
